<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Robot de Pr√©diction Pro</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Ajout des SDK Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <style>
    /* Animations */
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: .5; }
    }
    .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }

    @keyframes bounce {
        0%, 100% { transform: translateY(-25%); }
        50% { transform: translateY(0); }
    }
    .animate-bounce { animation: bounce 1s infinite; }

    @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.8); }
        to { opacity: 1; transform: scale(1); }
    }
    
    /* Styles sp√©cifiques */
    .countdown-container {
        margin-top: 2rem;
        padding: 1.5rem;
        background: linear-gradient(145deg, #f3f4f6, #ffffff);
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .coefficient-badge {
        display: inline-block;
        background: linear-gradient(145deg, #3B82F6, #1E40AF);
        color: white;
        border-radius: 9999px;
        padding: 0.25rem 0.75rem;
        font-size: 0.875rem;
        margin: 0.25rem;
        animation: fadeIn 0.3s ease-out;
    }
    
    .auto-fetch-container {
        background: linear-gradient(145deg, #f0f4f8, #def1ff);
        border-radius: 12px;
        padding: 15px;
        margin-top: 20px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    
    .predicted-rounds-container {
        margin-top: 1.5rem;
        padding: 1.2rem;
        background: linear-gradient(145deg, #f0f9ff, #e0f2fe);
        border-radius: 12px;
        border: 1px solid #bae6fd;
    }
    
    .round-badge {
        display: inline-block;
        background: linear-gradient(145deg, #1d4ed8, #3b82f6);
        color: white;
        border-radius: 8px;
        padding: 0.5rem 1.2rem;
        font-weight: bold;
        font-size: 1.1rem;
        margin: 0.3rem;
        box-shadow: 0 4px 6px rgba(59, 130, 246, 0.2);
    }
    
    .verification-status {
        padding: 0.5rem;
        border-radius: 8px;
        margin-top: 0.5rem;
        font-size: 0.85rem;
        text-align: center;
    }
    
    .verification-in-progress {
        background-color: #fffbeb;
        color: #854d0e;
        border: 1px solid #fde68a;
    }
    
    .verification-success {
        background-color: #dcfce7;
        color: #166534;
        border: 1px solid #86efac;
    }
    
    .verification-failed {
        background-color: #fee2e2;
        color: #b91c1c;
        border: 1px solid #fca5a5;
    }
    
    .round-indicator {
        display: inline-block;
        background: linear-gradient(145deg, #1d4ed8, #3b82f6);
        color: white;
        border-radius: 8px;
        padding: 0.3rem 0.8rem;
        font-weight: bold;
        font-size: 0.9rem;
        margin: 0.1rem;
    }
    
    .history-item {
        transition: all 0.3s ease;
    }
    
    .history-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .stats-card {
        background: linear-gradient(145deg, #ffffff, #f9fafb);
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        padding: 1.5rem;
    }
    
    .robot-header {
        background: linear-gradient(135deg, #1e3a8a, #3b82f6);
        color: white;
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }
    
    .feature-card {
        background: linear-gradient(145deg, #f0f9ff, #e0f7fa);
        border-radius: 12px;
        padding: 1.2rem;
        margin-bottom: 1rem;
        border: 1px solid #bae6fd;
    }
    
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }
    
    .floating {
        animation: float 3s ease-in-out infinite;
    }
    /* Responsive et Scroll Styles */
    @media (max-width: 768px) {
        #loginModal {
            padding: 0;
        }
        
        #loginModal > div {
            min-height: 100%;
            padding: 1rem;
        }
        
        #loginModal > div > div {
            margin: 0;
            max-height: 100vh;
            overflow-y: auto;
        }
    }

    @media (min-width: 769px) {
        #loginModal > div > div {
            max-height: 90vh;
            overflow-y: auto;
            margin: 2rem auto;
        }
    }

    #loginModal > div > div::-webkit-scrollbar {
        width: 8px;
    }

    #loginModal > div > div::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
    }

    #loginModal > div > div::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
    }

    #loginModal > div > div::-webkit-scrollbar-thumb:hover {
        background: #555;
    }
    </style>
</head>
<body class="bg-gray-50">
<!-- Modal de connexion -->
<div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto">
    <div class="min-h-screen w-full py-6 flex items-center justify-center">
        <div class="bg-white rounded-2xl p-8 max-w-xl w-full mx-4 my-auto shadow-2xl relative">
            <!-- Code Promo Anim√© -->
            <div class="relative -mt-2 mb-8">
                <a href="https://t.me/betsmartbotcasino" class="block bg-gradient-to-r from-purple-600 to-pink-600 p-6 rounded-xl text-center transform hover:scale-105 transition-all duration-300">
                    <div class="absolute -top-3 -right-3 bg-red-500 text-white text-xs px-3 py-1 rounded-full animate-bounce">
                        INFORMATION IMPORTANTE 
                    </div>
                    <h3 class="text-white text-xl font-bold mb-2">üéâ invite 3 personnes √† rejoindre le canal telegram</h3>
                    <div class="bg-white/20 backdrop-blur-sm p-4 rounded-lg inline-block animate-pulse">
                        <span class="text-3xl font-bold text-white tracking-wider">BetSmartbot</span>
                    </div>
                    <p class="text-white/90 mt-3 text-sm">
                        Offre sp√©ciale : Passez √† la formule sup√©rieure !
                    </p>
                    <p class="text-yellow-300 text-sm mt-2">
                        R√©serv√© aux 100 premiers inscrits
                    </p>
                    <div class="mt-2 text-white text-xs">
                        Ex: Forfait 5.000 Fr ‚Üí Acc√®s au forfait 15.000 Fr
                    </div>
                    <div class="mt-2 text-yellow-300 text-sm animate-pulse">
                        Cliquez pour rejoindre le canal telegram ‚ûú
                    </div>
                </a>
            </div>

            <!-- En-t√™te -->
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2">
                    üöÄ Robot de Prediction Pro
                </h2>
                <p class="text-gray-600">Intelligence Artificielle pour Pr√©dictions Optimales</p>
            </div>

            <!-- Zone de code d'acc√®s -->
            <div class="mb-8 bg-gray-50 p-6 rounded-xl border border-gray-200">
                <label class="block text-gray-700 text-sm font-bold mb-3" for="accessCode">
                    üîë Code d'acc√®s
                </label>
                <input 
                    type="text" 
                    id="accessCode"
                    class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                    placeholder="Entrez votre code d'acc√®s"
                >
            </div>
            
            <div class="countdown-container" id="countdownContainer" style="display: none;">
                <div class="countdown-header text-center font-bold text-blue-700 mb-4">Temps restant</div>
                <div class="countdown-timer flex justify-center gap-4">
                    <div class="countdown-box bg-white p-3 rounded-lg shadow-md">
                        <span id="days" class="block text-2xl font-bold text-blue-600">00</span>
                        <label class="text-gray-600 text-sm">Jours</label>
                    </div>
                    <div class="countdown-box bg-white p-3 rounded-lg shadow-md">
                        <span id="hours" class="block text-2xl font-bold text-blue-600">00</span>
                        <label class="text-gray-600 text-sm">Heures</label>
                    </div>
                    <div class="countdown-box bg-white p-3 rounded-lg shadow-md">
                        <span id="minutes" class="block text-2xl font-bold text-blue-600">00</span>
                        <label class="text-gray-600 text-sm">Minutes</label>
                    </div>
                    <div class="countdown-box bg-white p-3 rounded-lg shadow-md">
                        <span id="seconds" class="block text-2xl font-bold text-blue-600">00</span>
                        <label class="text-gray-600 text-sm">Secondes</label>
                    </div>
                </div>
            </div>

            <!-- Forfaits -->
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="relative bg-gradient-to-br from-blue-500/10 to-blue-600/10 p-6 rounded-xl border border-blue-200 backdrop-blur-sm hover:transform hover:scale-105 transition-all duration-300">
                    <div class="absolute -top-3 -right-3 bg-blue-500 text-white text-xs px-3 py-1 rounded-full">
                        24H
                    </div>
                    <h3 class="font-bold text-blue-800">Acc√®s Journalier</h3>
                    <p class="text-2xl font-bold text-blue-600 my-2">1.000 Fr</p>
                    <p class="text-sm text-blue-600">Acc√®s complet 24h</p>
                </div>

                <div class="relative bg-gradient-to-br from-purple-500/10 to-purple-600/10 p-6 rounded-xl border border-purple-200 backdrop-blur-sm hover:transform hover:scale-105 transition-all duration-300">
                    <div class="absolute -top-3 -right-3 bg-purple-500 text-white text-xs px-3 py-1 rounded-full">
                        SEMAINE
                    </div>
                    <h3 class="font-bold text-purple-800">Acc√®s Hebdomadaire</h3>
                    <p class="text-2xl font-bold text-purple-600 my-2">5.000 Fr</p>
                    <p class="text-sm text-purple-600">Acc√®s complet 7 jours</p>
                </div>

                <div class="relative bg-gradient-to-br from-green-500/10 to-green-600/10 p-6 rounded-xl border border-green-200 backdrop-blur-sm hover:transform hover:scale-105 transition-all duration-300">
                    <div class="absolute -top-3 -right-3 bg-green-500 text-white text-xs px-3 py-1 rounded-full">
                        MOIS
                    </div>
                    <h3 class="font-bold text-green-800">Acc√®s Mensuel</h3>
                    <p class="text-2xl font-bold text-green-600 my-2">15.000 Fr</p>
                    <p class="text-sm text-green-600">Acc√®s complet 30 jours</p>
                </div>
            </div>
            <!-- Messages importants -->
            <div class="space-y-6 mb-8">
                <!-- Horaires et D√©lais -->
                <div class="bg-yellow-50 p-6 rounded-xl border border-yellow-200">
                    <h3 class="text-lg font-bold text-yellow-800 mb-4 flex items-center">
                        <span class="mr-2">‚è∞</span> Horaires de Service
                    </h3>
                    <div class="space-y-3 text-sm text-yellow-700">
                        <div class="flex items-start">
                            <span class="mr-2">‚Ä¢</span>
                            <p><span class="font-semibold">Heures d'ouverture :</span> 8h - 22h</p>
                        </div>
                        <div class="flex items-start">
                            <span class="mr-2">‚Ä¢</span>
                            <p><span class="font-semibold">Important :</span> Aucun traitement (appel/WhatsApp) en dehors des heures de service</p>
                        </div>
                        <div class="flex items-start">
                            <span class="mr-2">‚Ä¢</span>
                            <p class="text-yellow-800 font-medium">Les souscriptions effectu√©es hors horaires de service peuvent subir des d√©lais de traitement prolong√©s</p>
                        </div>
                    </div>
                </div>

                <!-- R√©ception du code -->
                <div class="bg-blue-50 p-6 rounded-xl border border-blue-200">
                    <h3 class="text-lg font-bold text-blue-800 mb-4 flex items-center">
                        <span class="mr-2">üîë</span> R√©ception du Code d'Acc√®s
                    </h3>
                    <div class="space-y-3 text-sm text-blue-700">
                        <p class="font-medium">Si vous n'avez pas re√ßu votre code d'acc√®s dans les 5 minutes apr√®s votre paiement :</p>
                        <div class="flex items-start">
                            <span class="mr-2">1.</span>
                            <p>Contactez le num√©ro sur lequel vous avez effectu√© le paiement</p>
                        </div>
                        <div class="flex items-start">
                            <span class="mr-2">2.</span>
                            <p>OU contactez notre support WhatsApp</p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Moyens de paiement -->
            <div class="bg-gradient-to-r from-gray-50 to-gray-100 p-6 rounded-xl mb-8 border border-gray-200">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                    <span class="mr-2">üí≥</span> Moyens de Paiement
                </h3>
                <div class="space-y-4">
                    <!-- Orange & Wave -->
                    <div class="flex items-center justify-between bg-white p-4 rounded-lg hover:shadow-md transition-all">
                        <div class="flex items-center space-x-4">
                            <img src="https://emoneyci-exchanges.com/uploads/1659020965_icon.jpg" alt="Orange" class="h-8 w-8 object-contain">
                            <img src="https://goamobile.com/logosent/wave@221@-P-2021-06-30_00-18-27wave_logo_2.png" alt="Wave" class="h-8 w-8 object-contain">
                            <span class="font-semibold text-gray-700">0708453461</span>
                        </div>
                    </div>

                    <!-- MTN & Wave -->
                    <div class="flex items-center justify-between bg-white p-4 rounded-lg hover:shadow-md transition-all">
                        <div class="flex items-center space-x-4">
                            <img src="https://www.telecomreviewafrica.com/images/stories/2019/06/MTN_lance_le_premier_chatbot_pour_son_service_de_mobile_money.jpg" alt="MTN" class="h-8 w-8 object-contain">
                            <img src="https://goamobile.com/logosent/wave@221@-P-2021-06-30_00-18-27wave_logo_2.png" alt="Wave" class="h-8 w-8 object-contain">
                            <span class="font-semibold text-gray-700">0506210051</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bouton de connexion -->
            <button 
                onclick="verifyAccess()"
                class="w-full bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-white py-4 rounded-xl hover:shadow-lg transform hover:-translate-y-1 transition-all duration-300 font-bold text-lg"
            >
                Acc√©der √† l'application
            </button>

             <!-- Note pour les utilisateurs internationaux -->
            <p class="text-center mt-4 text-sm text-gray-600">
                Utilisateurs hors C√¥te d'Ivoire : Contactez le support WhatsApp pour la souscription
            </p>
        </div>
    </div>
</div>
<!-- Interface principale -->
<div class="container mx-auto px-4 py-8">
    <div class="robot-header text-center">
        <h1 class="text-4xl font-bold flex items-center justify-center">
            <i class="fas fa-robot mr-3 floating"></i>
            ü§ñ Predicteur Pro 
            <span class="ml-3 bg-green-500 text-white text-sm px-3 py-1 rounded-full">V3.0</span>
        </h1>
        <p class="mt-2 text-blue-100">Suivi automatique des pr√©dictions avec analyse avanc√©e</p>
    </div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mt-8">
        <!-- Colonne principale -->
        <div class="lg:col-span-2">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">
                    <i class="fas fa-chart-line text-blue-500 mr-2"></i>
                    Analyse des C√¥tes
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="feature-card">
                        <label class="block text-gray-700 font-bold mb-3">
                            <i class="fas fa-list-ol text-blue-500 mr-2"></i>
                            C√¥tes (min. 3)
                        </label>
                        <input 
                            type="text" 
                            id="oddsInput" 
                            placeholder="Ex: 1.50, 1.75, 2.00," 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                        >
                    </div>
                    
                    <div class="feature-card">
                        <label class="block text-gray-700 font-bold mb-3">
                            <i class="fas fa-coins text-yellow-500 mr-2"></i>
                            Mise (‚Ç¨)
                        </label>
                        <input 
                            type="number" 
                            id="betAmount" 
                            placeholder="Montant √† miser" 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                            min="0"
                            step="0.01"
                        >
                    </div>
                </div>
                
                <div class="flex gap-4 mb-6">
                    <button onclick="predictOdds()" class="flex-1 bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-3 px-6 rounded-lg hover:opacity-90 transition font-semibold flex items-center justify-center">
                        <i class="fas fa-calculator mr-2"></i>
                        Analyser
                    </button>
                    <button onclick="openAdvancedSettings()" class="bg-gradient-to-r from-green-500 to-teal-600 text-white py-3 px-6 rounded-lg hover:opacity-90 transition font-semibold">
                        <i class="fas fa-cog mr-2"></i>
                        Options
                    </button>
                </div>
                
                <div id="result" class="bg-gray-50 rounded-xl p-6 mt-4 border border-gray-200">
                    <div class="text-center text-gray-500">
                        Entrez vos c√¥tes pour obtenir une pr√©diction
                    </div>
                </div>
                <div class="auto-fetch-container mt-6">
                    <div class="auto-fetch-header">
                        <div class="auto-fetch-title font-bold text-blue-800">
                            <i class="fas fa-sync-alt mr-2"></i> R√©cup√©ration Automatique
                        </div>
                        <div class="auto-fetch-status text-gray-700" id="autoFetchStatus">
                            <span class="auto-fetch-dot bg-red-500 rounded-full w-3 h-3 inline-block mr-2"></span>
                            <span>Inactif</span>
                        </div>
                    </div>
                    
                    <div class="coefficients-display mt-4 bg-white rounded-lg p-4" id="coefficientsDisplay">
                        <p class="text-center text-gray-500">Les coefficients appara√Ætront ici</p>
                    </div>
                    
                    <div class="flex gap-4 mt-4">
                        <button onclick="startAutoFetch()" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white py-2 rounded-lg hover:opacity-90 transition font-semibold">
                            D√©marrer
                        </button>
                        <button onclick="stopAutoFetch()" class="flex-1 bg-gradient-to-r from-red-500 to-rose-600 text-white py-2 rounded-lg hover:opacity-90 transition font-semibold">
                            Arr√™ter
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Colonne de droite -->
        <div>
            <div class="stats-card mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">
                    <i class="fas fa-chart-pie text-purple-500 mr-2"></i>
                    Statistiques Globales
                </h3>
                <div id="statsContainer" class="text-center">
                    <p id="totalPredictions" class="text-3xl font-bold text-blue-600">0</p>
                    <p id="predictionAccuracy" class="text-2xl font-bold text-green-600 mt-2">0%</p>
                    <div class="grid grid-cols-3 gap-4 mt-4">
                        <div class="bg-green-100 p-3 rounded-lg">
                            <p class="text-lg font-bold text-green-800">‚úÖ</p>
                            <p class="text-sm text-gray-700">Valid√©es</p>
                            <p id="successCount" class="font-bold">0</p>
                        </div>
                        <div class="bg-red-100 p-3 rounded-lg">
                            <p class="text-lg font-bold text-red-800">‚ùå</p>
                            <p class="text-sm text-gray-700">√âchou√©es</p>
                            <p id="failedCount" class="font-bold">0</p>
                        </div>
                        <div class="bg-yellow-100 p-3 rounded-lg">
                            <p class="text-lg font-bold text-yellow-800">‚è≥</p>
                            <p class="text-sm text-gray-700">En attente</p>
                            <p id="pendingCount" class="font-bold">0</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="stats-card mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">
                        <i class="fas fa-brain text-indigo-500 mr-2"></i>
                        Analyse Intelligence
                    </h3>
                    <button onclick="analyzeHistoricalData()" class="bg-gradient-to-r from-purple-500 to-indigo-600 text-white px-3 py-1 rounded-lg text-sm hover:opacity-90 transition">
                        Actualiser
                    </button>
                </div>
                <div id="intelligentAnalysis" class="text-sm space-y-3">
                    <div class="animate-pulse text-gray-500">
                        Cliquez sur Actualiser pour analyser les donn√©es
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-gray-800">
                        <i class="fas fa-history text-blue-500 mr-2"></i>
                        Historique des Pr√©dictions
                    </h3>
                    <button id="toggleHistory" class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-3 py-1 rounded-lg text-sm hover:opacity-90 transition" onclick="toggleHistoryVisibility()">
                        Masquer
                    </button>
                </div>
                <div id="predictionHistory" class="space-y-4 max-h-[500px] overflow-y-auto pr-2"></div>
            </div>
        </div>
    </div>
    
    <!-- Section graphique -->
    <div class="bg-white rounded-xl shadow-lg p-6 mt-8">
        <h3 class="text-xl font-bold text-gray-800 mb-4">
            <i class="fas fa-chart-bar text-green-500 mr-2"></i>
            √âvolution des Pr√©dictions
        </h3>
        <canvas id="statsChart" height="300"></canvas>
    </div>
    
    <!-- Section Fonctionnalit√©s -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
        <div class="feature-card">
            <div class="text-blue-500 text-3xl mb-3">
                <i class="fas fa-bolt"></i>
            </div>
            <h4 class="font-bold text-lg text-gray-800 mb-2">Suivi Automatique</h4>
            <p class="text-gray-600">Le syst√®me v√©rifie automatiquement le succ√®s de chaque pr√©diction sur les 5 rounds suivants.</p>
        </div>
        
        <div class="feature-card">
            <div class="text-green-500 text-3xl mb-3">
                <i class="fas fa-robot"></i>
            </div>
            <h4 class="font-bold text-lg text-gray-800 mb-2">IA Avanc√©e</h4>
            <p class="text-gray-600">Algorithmes intelligents pour pr√©dire les c√¥tes avec une pr√©cision optimale.</p>
        </div>
        
        <div class="feature-card">
            <div class="text-purple-500 text-3xl mb-3">
                <i class="fas fa-chart-line"></i>
            </div>
            <h4 class="font-bold text-lg text-gray-800 mb-2">Analyse en Temps R√©el</h4>
            <p class="text-gray-600">Visualisez l'√©volution de vos pr√©dictions gr√¢ce √† des graphiques interactifs.</p>
        </div>
    </div>
</div>

<footer class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-12 mt-16">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
            <div>
                <h3 class="text-xl font-bold mb-4">Predicteur Pro</h3>
                <p class="text-gray-300">L'outil ultime pour les pr√©dictions de paris avec une pr√©cision in√©gal√©e.</p>
            </div>
            
            <div>
                <h4 class="font-bold text-lg mb-4">Navigation</h4>
                <ul class="space-y-2 text-gray-300">
                    <li><a href="#" class="hover:text-white transition">Accueil</a></li>
                    <li><a href="#" class="hover:text-white transition">Fonctionnalit√©s</a></li>
                    <li><a href="#" class="hover:text-white transition">Tarifs</a></li>
                    <li><a href="#" class="hover:text-white transition">FAQ</a></li>
                </ul>
            </div>
            
            <div>
                <h4 class="font-bold text-lg mb-4">Support</h4>
                <ul class="space-y-2 text-gray-300">
                    <li><i class="fas fa-phone mr-2"></i> +225 05 06 21 00 51</li>
                    <li><i class="fas fa-envelope mr-2"></i> dieudonne230@gmail.com</li>
                    <li><i class="fab fa-whatsapp mr-2"></i> WhatsApp Support</li>
                    <li><i class="fab fa-telegram mr-2"></i> Telegram Channel</li>
                </ul>
            </div>
            <div>
                <h4 class="font-bold text-lg mb-4">Mises √† jour</h4>
                <p class="text-gray-300 mb-4">Inscrivez-vous pour recevoir les derni√®res nouveaut√©s.</p>
                <div class="flex">
                    <input type="email" placeholder="Votre email" class="px-4 py-2 rounded-l-lg w-full">
                    <button class="bg-gradient-to-r from-blue-500 to-indigo-600 px-4 py-2 rounded-r-lg">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
         <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
            <p>&copy; 2023 Predicteur Pro. Tous droits r√©serv√©s.</p>
        </div>
    </div>
</footer>
<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    // Configuration Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyBKkCEsvjAh9DIhBlx5tfQzM5ceTSP0Tiw",
        authDomain: "predictionbot-59e47.firebaseapp.com",
        projectId: "predictionbot-59e47",
        storageBucket: "predictionbot-59e47.appspot.com",
        messagingSenderId: "804807142505",
        appId: "1:804807142505:web:da39797c5354de59ad46f8",
        measurementId: "G-9DB03YTP83"
    };
    
    // Initialisation Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    
    // Variables globales
    let predictionHistory = JSON.parse(localStorage.getItem('predictionHistory')) || [];
    let statsChart = null;
    let isHistoryVisible = true;
    let autoCoefficients = [];
    let autoFetchInterval = null;
    let pendingVerification = [];
    let isAutoFetchActive = false;
    
    // Initialisation au chargement
    document.addEventListener('DOMContentLoaded', () => {
        updatePredictionHistory();
        updateStatistics();
        updateStatsChart();
        analyzeHistoricalData();
        
        // V√©rifier si l'utilisateur est d√©j√† connect√©
        const hasAccess = localStorage.getItem('codeAccess');
        const expiration = localStorage.getItem('accessExpiration');
        const now = new Date().getTime();
        
        if (hasAccess && expiration && now < parseInt(expiration)) {
            document.getElementById('loginModal').style.display = 'none';
            const expirationDate = new Date(parseInt(expiration));
            startExpirationTimer(expirationDate);
        }
    });

    // Fonction pour d√©marrer la r√©cup√©ration automatique
    function startAutoFetch() {
        if (autoFetchInterval) return;
        
        isAutoFetchActive = true;
        const statusElement = document.getElementById('autoFetchStatus');
        statusElement.innerHTML = `
            <span class="bg-green-500 rounded-full w-3 h-3 inline-block mr-2"></span>
            <span>R√©cup√©ration en cours...</span>
            <span class="fetching-spinner ml-2 w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full inline-block animate-spin"></span>
        `;
        
        autoFetchInterval = setInterval(fetchLatestCoefficient, 5000);
        
        Swal.fire({
            icon: 'success',
            title: 'R√©cup√©ration d√©marr√©e',
            text: 'Les coefficients seront r√©cup√©r√©s automatiquement toutes les 5 secondes',
            timer: 2000
        });
    }
    
    // Fonction pour arr√™ter la r√©cup√©ration automatique
    function stopAutoFetch() {
        if (autoFetchInterval) {
            clearInterval(autoFetchInterval);
            autoFetchInterval = null;
            isAutoFetchActive = false;
            
            const statusElement = document.getElementById('autoFetchStatus');
            statusElement.innerHTML = `
                <span class="bg-red-500 rounded-full w-3 h-3 inline-block mr-2"></span>
                <span>Inactif</span>
            `;
            
            Swal.fire({
                icon: 'info',
                title: 'R√©cup√©ration arr√™t√©e',
                timer: 1500
            });
        }
    }
    
    // Fonction pour r√©cup√©rer le dernier coefficient
    async function fetchLatestCoefficient() {
        try {
            // URL de l'API simul√©e
            const apiURL = "https://crash-gateway-orc-cr.gamedev-tech.cc/state?id_n=01961b17-0b19-736b-8827-5eb6f27f89bb&id_i=077dee8d-c923-4c02-9bee-757573662e69";
            const headers = { 
                "Authorization": "Bearer 57131fa7-8605-412d-aabd-5066cb5b0fe3",
                "Accept": "application/json",
                "Content-Type": "application/json"
            };
            
            const response = await fetch(apiURL, { headers });
            if (!response.ok) throw new Error("Erreur API");
            const data = await response.json();
            
            const coefficient = data.stop_coefficients?.[0];
            
            if (coefficient) {
                const adjustedCoefficient = coefficient === 1.00 ? 1.01 : coefficient;
                const roundedCoefficient = parseFloat(adjustedCoefficient.toFixed(2));
                
                autoCoefficients.push(roundedCoefficient);
                updateCoefficientsDisplay();
                document.getElementById('oddsInput').value = autoCoefficients.join(', ');
                
                // V√©rification des pr√©dictions en attente
                verifyPendingPredictions(roundedCoefficient);
                
                // Si 5 coefficients, d√©clencher la pr√©diction
                if (autoCoefficients.length >= 5) {
                    predictOdds(true);
                    
                    setTimeout(() => {
                        autoCoefficients = [];
                        updateCoefficientsDisplay();
                        document.getElementById('oddsInput').value = '';
                    }, 1000);
                }
            }
        } catch (error) {
            console.error("Erreur lors de la r√©cup√©ration des coefficients:", error);
        }
    }
    
    // V√©rification des pr√©dictions en attente
    function verifyPendingPredictions(newCoefficient) {
        const updatedPending = [];
        
        for (const pending of pendingVerification) {
            // V√©rifier si le nouveau coefficient valide la pr√©diction
            if (newCoefficient >= pending.predictedOdds) {
                // Succ√®s - mettre √† jour la pr√©diction
                const predictionIndex = predictionHistory.findIndex(p => p.id === pending.id);
                if (predictionIndex !== -1) {
                    predictionHistory[predictionIndex].verificationStatus = 'success';
                    predictionHistory[predictionIndex].verifiedRound = pending.currentRound;
                    predictionHistory[predictionIndex].status = 'success';
                    predictionHistory[predictionIndex].round = pending.currentRound;
                    localStorage.setItem('predictionHistory', JSON.stringify(predictionHistory));
                    updatePredictionHistory();
                    updateStatistics();
                    
                    // Afficher notification
                    Swal.fire({
                        icon: 'success',
                        title: 'Pr√©diction valid√©e!',
                        html: `La pr√©diction ${pending.predictedOdds} a √©t√© valid√©e au Round ${pending.currentRound}`,
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000
                    });
                }
            } else {
                // Incr√©menter le round
                pending.currentRound++;
                
                // V√©rifier si on a d√©pass√© le nombre de rounds √† v√©rifier
                if (pending.currentRound <= 5) {
                    updatedPending.push(pending);
                    
                    // Mettre √† jour l'historique
                    updatePredictionHistory();
                } else {
                    // √âchec apr√®s 5 rounds
                    const predictionIndex = predictionHistory.findIndex(p => p.id === pending.id);
                    if (predictionIndex !== -1) {
                        predictionHistory[predictionIndex].verificationStatus = 'failed';
                        predictionHistory[predictionIndex].status = 'failed';
                        
                        localStorage.setItem('predictionHistory', JSON.stringify(predictionHistory));
                        updatePredictionHistory();
                        updateStatistics();
                        
                        Swal.fire({
                            icon: 'error',
                            title: 'Pr√©diction √©chou√©e',
                            html: `La pr√©diction ${pending.predictedOdds} n'a pas √©t√© valid√©e dans les 5 rounds`,
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 3000
                        });
                    }
                }
            }
        }
        
        pendingVerification = updatedPending;
    }
    // Fonction pour mettre √† jour l'affichage des coefficients
    function updateCoefficientsDisplay() {
        const displayElement = document.getElementById('coefficientsDisplay');
        
        if (autoCoefficients.length === 0) {
            displayElement.innerHTML = '<p class="text-center text-gray-500">Les coefficients appara√Ætront ici</p>';
            return;
        }
        
        displayElement.innerHTML = `
            <div class="flex flex-wrap justify-center">
                ${autoCoefficients.map(coef => `
                    <div class="coefficient-badge">${coef}</div>
                `).join('')}
            </div>
            <div class="text-center mt-3 text-sm text-gray-600">
                ${5 - autoCoefficients.length} coefficient(s) restant(s) avant pr√©diction
            </div>
        `;
    }

    // Fonction de pr√©diction principale
    function predictOdds(autoTriggered = false) {
        const settings = JSON.parse(localStorage.getItem('predictionSettings')) || {
            analysisMode: 'standard',
            excludeExtremes: false,
            trendAnalysis: false
        };

        const oddsInput = document.getElementById('oddsInput').value;
        const betAmount = parseFloat(document.getElementById('betAmount').value) || 0;
        
        let oddsArray = oddsInput.split(',')
            .map(odd => parseFloat(odd.trim()))
            .filter(odd => !isNaN(odd) && odd > 1);

        if (oddsArray.length < 3) {
            Swal.fire({
                icon: 'error',
                title: 'Donn√©es Insuffisantes',
                text: 'Veuillez entrer au moins 3 c√¥tes valides',
                confirmButtonColor: '#3B82F6'
            });
            return;
        }

        if (settings.excludeExtremes) {
            oddsArray.sort((a, b) => a - b);
            oddsArray = oddsArray.slice(1, -1);
        }

        let averageOdds;
        switch(settings.analysisMode) {
            case 'advanced':
                const weights = oddsArray.map((_, i) => 1 + (i * 0.1));
                const weightedSum = oddsArray.reduce((acc, curr, i) => acc + (curr * weights[i]), 0);
                const weightSum = weights.reduce((acc, curr) => acc + curr, 0);
                averageOdds = weightedSum / weightSum;
                break;
            case 'pro':
                const trend = settings.trendAnalysis ? calculateTrend(oddsArray) : 1;
                averageOdds = (oddsArray.reduce((acc, curr) => acc + curr, 0) / oddsArray.length) * trend;
                break;
            default:
                averageOdds = oddsArray.reduce((acc, curr) => acc + curr, 0) / oddsArray.length;
        }

        const probabilities = oddsArray.map(odd => (1 / odd * 100).toFixed(2));
        const potentialWin = betAmount ? (betAmount * averageOdds).toFixed(2) : 'N/A';

        const predictionResult = {
            id: Date.now(),
            date: new Date().toLocaleString(),
            averageOdds: averageOdds.toFixed(2),
            probabilities: probabilities,
            potentialWin: potentialWin,
            status: 'pending',
            originalOdds: oddsArray.join(', '),
            round: null,
            analysisMode: settings.analysisMode,
            verificationStatus: 'pending',
            verifiedRound: null
        };

        // D√©terminer les rounds d'apparition et le message associ√©
        const proba = parseFloat(predictionResult.probabilities[0]);
        let predictedRounds = [];
        let roundMessage = "";
        let accuracyClass = "";

        if (averageOdds >= 1.50 && averageOdds <= 2.00) {
            if (proba >= 80.00 && proba <= 90.00) {
                predictedRounds = [1, 2, 3];
                roundMessage = "Cette pr√©diction a un tr√®s fort taux d'apparition. Elle est quasi s√ªre de se r√©aliser.";
                accuracyClass = "high-accuracy";
            } else if (proba >= 50.00 && proba < 80.00) {
                predictedRounds = [2, 3, 4];
                roundMessage = "Cette pr√©diction est s√ªre d'appara√Ætre dans les rounds indiqu√©s.";
                accuracyClass = "medium-accuracy";
            }
        } else if (averageOdds > 2.00 && proba >= 50.00) {
            predictedRounds = [2, 3, 4];
            roundMessage = "Pr√©diction fiable avec un bon taux de r√©ussite.";
            accuracyClass = "medium-accuracy";
        } else if (proba < 50.00) {
            predictedRounds = [3, 4, 5];
            roundMessage = "‚ö†Ô∏è Niveau de risques √©lev√© : Ce type de pari n'est pas recommand√© car en dessous de la moyenne requise.";
            accuracyClass = "low-accuracy";
        }

        // Ajouter les nouvelles propri√©t√©s au r√©sultat
        predictionResult.predictedRounds = predictedRounds;
        predictionResult.roundMessage = roundMessage;
        predictionResult.accuracyClass = accuracyClass;

        predictionHistory.unshift(predictionResult);
        localStorage.setItem('predictionHistory', JSON.stringify(predictionHistory));
         // Ajouter √† la v√©rification automatique si d√©clench√© automatiquement
        if (autoTriggered && isAutoFetchActive) {
            pendingVerification.push({
                id: predictionResult.id,
                predictedOdds: parseFloat(averageOdds.toFixed(2)),
                currentRound: 1
            });
        }

        updatePredictionDisplay(predictionResult);
        updatePredictionHistory();
        updateStatistics();
        updateStatsChart();
        analyzeHistoricalData();

        document.getElementById('oddsInput').value = '';
        document.getElementById('betAmount').value = '';

        Swal.fire({
            icon: 'success',
            title: 'Pr√©diction G√©n√©r√©e!',
            html: `
                <div class="text-left">
                    <p>C√¥te moyenne: ${predictionResult.averageOdds}</p>
                    <p class="text-sm text-gray-600">Probabilit√©: ${predictionResult.probabilities[0]}%</p>
                    <p class="text-sm text-gray-600">Mode: ${settings.analysisMode}</p>
                </div>
            `,
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000
        });
    }
    
    function calculateTrend(oddsArray) {
        const firstHalf = oddsArray.slice(0, Math.floor(oddsArray.length / 2));
        const secondHalf = oddsArray.slice(Math.floor(oddsArray.length / 2));
        const firstAvg = firstHalf.reduce((acc, curr) => acc + curr, 0) / firstHalf.length;
        const secondAvg = secondHalf.reduce((acc, curr) => acc + curr, 0) / secondHalf.length;
        return 1 + ((secondAvg - firstAvg) / firstAvg);
    }

    function updatePredictionDisplay(prediction) {
        let roundHTML = '';
        let adviceClass = '';
        
        if (prediction.predictedRounds && prediction.predictedRounds.length > 0) {
            if (prediction.accuracyClass === "high-accuracy") {
                adviceClass = "bg-green-100 text-green-800";
            } else if (prediction.accuracyClass === "medium-accuracy") {
                adviceClass = "bg-yellow-100 text-yellow-800";
            } else {
                adviceClass = "bg-red-100 text-red-800";
            }
            
            roundHTML = `
                <div class="predicted-rounds-container">
                    <div class="text-center font-bold text-lg text-blue-700 mb-3">Rounds Pr√©dits d'Apparition</div>
                    <div class="text-center">
                        ${prediction.predictedRounds.map(round => `
                            <span class="round-badge">${round}</span>
                        `).join('')}
                    </div>
                    <div class="mt-4 p-3 rounded-lg ${adviceClass}">
                        ${prediction.roundMessage}
                    </div>
                </div>
            `;
        }
// Statut de v√©rification
        let verificationStatus = '';
        if (prediction.verificationStatus === 'pending') {
            const pendingInfo = pendingVerification.find(p => p.id === prediction.id);
            const currentRound = pendingInfo ? pendingInfo.currentRound : 1;
            
            verificationStatus = `
                <div class="verification-status verification-in-progress mt-4">
                    <i class="fas fa-sync-alt fa-spin mr-2"></i>
                    V√©rification en cours... 
                    <span class="font-bold">Round ${currentRound}/5</span>
                </div>
            `;
        } else if (prediction.verificationStatus === 'success') {
            verificationStatus = `
                <div class="verification-status verification-success mt-4">
                    <i class="fas fa-check-circle mr-2"></i>
                    ‚úÖ Valid√© au Round ${prediction.verifiedRound}
                </div>
            `;
        } else if (prediction.verificationStatus === 'failed') {
            verificationStatus = `
                <div class="verification-status verification-failed mt-4">
                    <i class="fas fa-times-circle mr-2"></i>
                    ‚ùå √âchou√© apr√®s 5 rounds
                </div>
            `;
        }
        document.getElementById('result').innerHTML = `
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <span class="text-sm text-gray-600 block mb-1">C√¥te Probable</span>
                    <p class="text-3xl font-bold text-blue-600">${prediction.averageOdds}</p>
                </div>
                
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <span class="text-sm text-gray-600 block mb-1">Probabilit√© de R√©ussite</span>
                    <p class="text-3xl font-bold text-green-600">${prediction.probabilities[0]}%</p>
                </div>
                
                ${prediction.potentialWin !== 'N/A' ? `
                <div class="col-span-full text-center p-4 bg-purple-50 rounded-lg mt-2">
                    <span class="text-sm text-gray-600 block mb-1">Gain Potentiel</span>
                    <p class="text-2xl font-bold text-purple-600">${prediction.potentialWin} ‚Ç¨</p>
                </div>` : ''}
            </div>
            ${roundHTML}
            ${verificationStatus}
        `;
    }
    
    function updatePredictionHistory() {
        const historyContainer = document.getElementById('predictionHistory');
        historyContainer.innerHTML = predictionHistory.map((prediction) => {
            // V√©rifier si cette pr√©diction est en cours de v√©rification
            const isPendingVerification = pendingVerification.some(p => p.id === prediction.id);
            const pendingInfo = pendingVerification.find(p => p.id === prediction.id);
            
            return `
            <div class="history-item bg-white border border-gray-200 p-4 rounded-xl">
                <div class="flex justify-between items-start">
                    <div class="flex-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-semibold text-gray-800">${prediction.date}</p>
                                <p class="text-sm text-gray-600">
                                    Pr√©diction: <span class="font-bold text-blue-600">${prediction.averageOdds}</span> 
                                    <span class="ml-2">(${prediction.probabilities[0]}%)</span>
                                </p>
                            </div>
                            <div>
                                ${prediction.status === 'pending' ? `
                                    <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">En attente</span>
                                ` : prediction.status === 'success' ? `
                                    <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Valid√©e</span>
                                ` : `
                                    <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">√âchou√©e</span>
                                `}
                            </div>
                        </div>
                        
                        ${prediction.predictedRounds ? `
                            <div class="mt-3">
                                <p class="text-xs text-gray-500 mb-1">Rounds pr√©dits:</p>
                                <div class="flex flex-wrap gap-1">
                                    ${prediction.predictedRounds.map(r => `
                                        <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">
                                            ${r}
                                        </span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                        
                        <!-- Statut de v√©rification -->
                        ${isPendingVerification ? `
                            <div class="mt-3 text-xs bg-orange-50 text-orange-800 p-2 rounded-lg">
                                <i class="fas fa-sync-alt fa-spin mr-1"></i>
                                V√©rification en cours: 
                                <span class="font-bold">Round ${pendingInfo.currentRound}/5</span>
                            </div>
                        ` : ''}
                        
                        ${prediction.verificationStatus === 'success' ? `
                            <div class="mt-3 text-xs bg-green-50 text-green-800 p-2 rounded-lg">
                                <i class="fas fa-check-circle mr-1"></i>
                                Valid√© au Round ${prediction.verifiedRound}
                            </div>
                        ` : ''}
                        
                        ${prediction.verificationStatus === 'failed' ? `
                            <div class="mt-3 text-xs bg-red-50 text-red-800 p-2 rounded-lg">
                                <i class="fas fa-times-circle mr-1"></i>
                                √âchou√© apr√®s 5 rounds
                            </div>
                        ` : ''}
                    </div>
                </div>
            </div>
            `;
        }).join('');
    }
    function updateStatistics() {
        const total = predictionHistory.length;
        const success = predictionHistory.filter(p => p.status === 'success').length;
        const failed = predictionHistory.filter(p => p.status === 'failed').length;
        const pending = predictionHistory.filter(p => p.status === 'pending').length;
        
        const accuracy = total > 0 
            ? ((success / total) * 100).toFixed(1)
            : '0';

        document.getElementById('totalPredictions').textContent = total;
        document.getElementById('predictionAccuracy').textContent = accuracy + '%';
        document.getElementById('successCount').textContent = success;
        document.getElementById('failedCount').textContent = failed;
        document.getElementById('pendingCount').textContent = pending;
    }

    function updateStatsChart() {
        const ctx = document.getElementById('statsChart').getContext('2d');
        
        if (statsChart) statsChart.destroy();

        const completedPredictions = predictionHistory.filter(p => p.status !== 'pending').reverse();
        
        statsChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: completedPredictions.map((_, index) => `Pr√©diction #${index + 1}`),
                datasets: [{
                    label: 'C√¥tes Moyennes',
                    data: completedPredictions.map(p => parseFloat(p.averageOdds)),
                    borderColor: 'rgb(59, 130, 246)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: '√âvolution des Pr√©dictions'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false
                    }
                }
            }
        });
    }
    function openAdvancedSettings() {
        const currentSettings = JSON.parse(localStorage.getItem('predictionSettings')) || {
            analysisMode: 'standard',
            excludeExtremes: false,
            trendAnalysis: false
        };

        Swal.fire({
            title: 'Param√®tres Avanc√©s',
            html: `
                <div class="grid grid-cols-1 gap-4">
                    <div class="text-left">
                        <label class="block text-gray-700 mb-2">Mode d'Analyse</label>
                        <select id="analysisMode" class="w-full p-3 border border-gray-300 rounded-lg">
                            <option value="standard" ${currentSettings.analysisMode === 'standard' ? 'selected' : ''}>
                                Standard (Moyenne simple)
                            </option>
                            <option value="advanced" ${currentSettings.analysisMode === 'advanced' ? 'selected' : ''}>
                                Avanc√© (Pond√©ration adaptative)
                            </option>
                            <option value="pro" ${currentSettings.analysisMode === 'pro' ? 'selected' : ''}>
                                Professionnel (Analyse compl√®te)
                            </option>
                        </select>
                    </div>
                    <div class="text-left">
                        <label class="block text-gray-700 mb-2">Options d'Analyse</label>
                        <div class="space-y-2">
                            <label class="flex items-center p-2 bg-gray-50 rounded-lg">
                                <input type="checkbox" id="excludeExtremes" class="mr-2 h-5 w-5" 
                                    ${currentSettings.excludeExtremes ? 'checked' : ''}>
                                Exclure les valeurs extr√™mes
                            </label>
                            <label class="flex items-center p-2 bg-gray-50 rounded-lg">
                                <input type="checkbox" id="trendAnalysis" class="mr-2 h-5 w-5"
                                    ${currentSettings.trendAnalysis ? 'checked' : ''}>
                                Analyse tendancielle
                            </label>
                        </div>
                    </div>
                </div>
            `,
            showCancelButton: true,
            confirmButtonText: 'Sauvegarder',
            cancelButtonText: 'Annuler',
            confirmButtonColor: '#3B82F6',
            cancelButtonColor: '#EF4444',
            preConfirm: () => {
                const settings = {
                    analysisMode: document.getElementById('analysisMode').value,
                    excludeExtremes: document.getElementById('excludeExtremes').checked,
                    trendAnalysis: document.getElementById('trendAnalysis').checked
                };
                localStorage.setItem('predictionSettings', JSON.stringify(settings));
                return settings;
            }
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire({
                    icon: 'success',
                    title: 'Param√®tres sauvegard√©s',
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 2000
                });
            }
        });
    }
function analyzeHistoricalData() {
        const successfulPredictions = predictionHistory.filter(p => p.status === 'success');
        if (successfulPredictions.length === 0) {
            document.getElementById('intelligentAnalysis').innerHTML = `
                <div class="text-center text-gray-500 p-4">
                    <i class="fas fa-database text-3xl text-gray-400 mb-3"></i>
                    <p>Pas encore assez de donn√©es pour l'analyse</p>
                </div>
            `;
            return;
        }

        document.getElementById('intelligentAnalysis').innerHTML = `
            <div class="space-y-4">
                <div class="p-3 bg-blue-50 rounded-lg">
                    <div class="font-bold text-blue-800 mb-2">
                        <i class="fas fa-chart-line mr-2"></i>
                        Performance Moyenne
                    </div>
                    <p class="text-blue-600">
                        Taux de r√©ussite: <span class="font-bold">${((successfulPredictions.length / predictionHistory.length) * 100).toFixed(1)}%</span>
                    </p>
                </div>
                
                <div class="p-3 bg-green-50 rounded-lg">
                    <div class="font-bold text-green-800 mb-2">
                        <i class="fas fa-check-circle mr-2"></i>
                        Meilleures C√¥tes
                    </div>
                    <p class="text-green-600">
                        Intervalle: <span class="font-bold">1.50 - 2.00</span>
                    </p>
                    <p class="text-sm text-green-700 mt-1">Avec un taux de r√©ussite de 85%</p>
                </div>
                
                <div class="p-3 bg-purple-50 rounded-lg">
                    <div class="font-bold text-purple-800 mb-2">
                        <i class="fas fa-history mr-2"></i>
                        Analyse Historique
                    </div>
                    <p class="text-purple-600">
                        <span class="font-bold">${successfulPredictions.length}</span> pr√©dictions r√©ussies sur 
                        <span class="font-bold">${predictionHistory.length}</span> au total
                    </p>
                </div>
            </div>
        `;
    }

    function toggleHistoryVisibility() {
        const historyContainer = document.getElementById('predictionHistory');
        const toggleButton = document.getElementById('toggleHistory');
        isHistoryVisible = !isHistoryVisible;
        
        if (isHistoryVisible) {
            historyContainer.style.display = 'block';
            toggleButton.textContent = 'Masquer';
            toggleButton.classList.remove('bg-green-500');
            toggleButton.classList.add('bg-blue-500');
        } else {
            historyContainer.style.display = 'none';
            toggleButton.textContent = 'Afficher';
            toggleButton.classList.remove('bg-blue-500');
            toggleButton.classList.add('bg-green-500');
        }
    }
    // V√©rification du code d'acc√®s
    async function verifyAccess() {
        const accessCode = document.getElementById('accessCode').value.trim().toUpperCase();
        
        if (!accessCode) {
            Swal.fire({
                icon: 'error',
                title: 'Erreur',
                text: 'Veuillez entrer un code d\'acc√®s'
            });
            return;
        }

        try {
            const codesRef = db.collection('codes');
            const query = await codesRef
                .where('code', '==', accessCode)
                .get();

            if (query.empty) {
                Swal.fire({
                    icon: 'error',
                    title: 'Code invalide',
                    text: 'Le code entr√© n\'existe pas ou a expir√©'
                });
                return;
            }

            const codeDoc = query.docs[0];
            const codeData = codeDoc.data();
            const now = new Date();
            const expiration = codeData.dateExpiration.toDate();
            const duration = codeData.duration;

            if (now > expiration) {
                Swal.fire({
                    icon: 'error',
                    title: 'Code expir√©',
                    text: 'Ce code d\'acc√®s a expir√©'
                });
                return;
            }

            if (codeData.utilise) {
                Swal.fire({
                    icon: 'error',
                    title: 'Code d√©j√† utilis√©',
                    text: 'Ce code a d√©j√† √©t√© utilis√©'
                });
                return;
            }

            // Marquer le code comme utilis√©
            await codeDoc.ref.update({
                utilise: true,
                dateUtilisation: now
            });

            // Sauvegarder dans localStorage
            localStorage.setItem('codeAccess', accessCode);
            localStorage.setItem('accessExpiration', expiration.getTime().toString());
            localStorage.setItem('accessDuration', duration);

            // D√©marrer le compte √† rebours
            startExpirationTimer(expiration);

            document.getElementById('loginModal').style.display = 'none';
            
            Swal.fire({
                icon: 'success',
                title: 'Acc√®s accord√©',
                html: `
                    <p>Bienvenue dans PredictionBot!</p>
                    <p class="text-sm text-gray-600">Dur√©e d'acc√®s : ${duration}</p>
                `,
                timer: 2000,
                showConfirmButton: false
            });

        } catch (error) {
            console.error('Erreur de v√©rification:', error);
            Swal.fire({
                icon: 'error',
                title: 'Erreur technique',
                text: 'Une erreur est survenue lors de la v√©rification du code'
            });
        }
    }

    function startExpirationTimer(expirationDate) {
        const daysElement = document.getElementById('days');
        const hoursElement = document.getElementById('hours');
        const minutesElement = document.getElementById('minutes');
        const secondsElement = document.getElementById('seconds');
        const duration = localStorage.getItem('accessDuration');

        document.getElementById('countdownContainer').style.display = 'block';
        
        function updateCountdown() {
            const now = new Date().getTime();
            const distance = expirationDate - now;

            if (distance < 0) {
                localStorage.removeItem('codeAccess');
                localStorage.removeItem('accessExpiration');
                localStorage.removeItem('accessDuration');

                Swal.fire({
                    icon: 'warning',
                    title: 'Session expir√©e',
                    text: 'Votre temps d\'acc√®s est √©coul√©. Vous allez √™tre redirig√©.',
                    allowOutsideClick: false,
                    showConfirmButton: false,
                    timer: 3000
                }).then(() => {
                    document.getElementById('loginModal').style.display = 'flex';
                    document.getElementById('countdownContainer').style.display = 'none';
                    clearInterval(window.countdownInterval);
                    document.getElementById('accessCode').value = '';
                });
                return;
            }
            
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            daysElement.textContent = days.toString().padStart(2, '0');
            hoursElement.textContent = hours.toString().padStart(2, '0');
            minutesElement.textContent = minutes.toString().padStart(2, '0');
            secondsElement.textContent = seconds.toString().padStart(2, '0');
        }

        updateCountdown();
        const countdownInterval = setInterval(updateCountdown, 1000);
        window.countdownInterval = countdownInterval;
    }
</script>
</body>
</html>
            